
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.2">
    
    
      
        <title>Static Analysis - DevSecOps Pipeline</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#objective" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DevSecOps Pipeline" class="md-header__button md-logo" aria-label="DevSecOps Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DevSecOps Pipeline
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Static Analysis
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DevSecOps Pipeline" class="md-nav__button md-logo" aria-label="DevSecOps Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    DevSecOps Pipeline
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contents/" class="md-nav__link">
        Table of Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../problem_statements/" class="md-nav__link">
        Problem Statements
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vm_setup/" class="md-nav__link">
        Setup of VMs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../jenkins_setup/" class="md-nav__link">
        Setup of Jenkins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../production_setup/" class="md-nav__link">
        Setup of Production Server
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ssh_connection/" class="md-nav__link">
        SSH Connection between VMs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../working_of_pipeline/" class="md-nav__link">
        Working of Pipeline
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Static Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Static Analysis
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nodejsscan" class="md-nav__link">
    NodeJsScan
  </a>
  
    <nav class="md-nav" aria-label="NodeJsScan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodejsscan-pipeline" class="md-nav__link">
    NodeJsScan Pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auditjs" class="md-nav__link">
    Auditjs
  </a>
  
    <nav class="md-nav" aria-label="Auditjs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auditjs-pipeline" class="md-nav__link">
    AuditJs Pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sast-pipeline" class="md-nav__link">
    SAST Pipeline
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sca/" class="md-nav__link">
        Software Composition Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_analysis/" class="md-nav__link">
        Dynamic Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sbom/" class="md-nav__link">
        Software Bill of Materials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../scqa/" class="md-nav__link">
        Software Code Quality Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../complete_pipeline/" class="md-nav__link">
        Complete Pipeline
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../aws/" class="md-nav__link">
        Shift Local Setup to AWS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../secrets_management/" class="md-nav__link">
        Secrets Management
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nodejsscan" class="md-nav__link">
    NodeJsScan
  </a>
  
    <nav class="md-nav" aria-label="NodeJsScan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodejsscan-pipeline" class="md-nav__link">
    NodeJsScan Pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auditjs" class="md-nav__link">
    Auditjs
  </a>
  
    <nav class="md-nav" aria-label="Auditjs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auditjs-pipeline" class="md-nav__link">
    AuditJs Pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sast-pipeline" class="md-nav__link">
    SAST Pipeline
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Static Analysis</h1>
                
                <h3 id="objective"><strong>Objective</strong></h3>
<p>The aim of this section is to perform static analysis on DVNA using SAST tools in a Jenkins pipeline and solve the 4th point of the <a href="../problem_statements/">Problem Statement</a> under Task 1.</p>
<p>About SAST</p>
<ul>
<li>Static application security testing (SAST) is a testing methodology that analyzes source code to find security vulnerabilities.</li>
<li>SAST scans an application before the code is compiled. Since the test is performed on the source code, ie. the internal structures or workings of an application, and not its functionality, its also called white box testing.</li>
</ul>
<p>Prerequisites</p>
<ul>
<li>An application (DVNA) running on Production Server.</li>
</ul>
<hr />
<h3 id="nodejsscan"><strong>NodeJsScan</strong></h3>
<p>NodeJsScan is a static code scanner which is used to find security flaws in Node.js applications.</p>
<p>In the Jenkins server, enter DVNA container in exec mode.</p>
<pre><code class="language-bash">sudo docker exec -it -u 0 dvna-app /bin/bash
</code></pre>
<p>Following the <a href="https://github.com/ajinabraham/nodejsscan">official documentation</a> available on GitHub, I installed njsscan using pip3. To use pip3, we first need to install it in the <code>dvna-app</code> container in production server.</p>
<pre><code class="language-bash">apt update &amp;&amp; apt install python3-pip
</code></pre>
<p>Install njsscan using pip3.</p>
<pre><code class="language-bash">pip3 install njsscan
</code></pre>
<p>Scan the <code>~/app</code> directory (which holds the files for DVNA) and store the scan result in <code>~/reports/nodejsscan-report</code></p>
<pre><code class="language-bash">mkdir ~/reports

njsscan --json -o /app/reports/nodejsscan-report ~/app
</code></pre>
<h4 id="nodejsscan-pipeline"><strong>NodeJsScan Pipeline</strong></h4>
<pre><code class="language-bash">stage('NodeJsScan') {
  steps {
    sh 'njsscan --json -o ~/reports/nodejsscan-report ~/app || true'
  }
}
</code></pre>
<p>The complete report generated by NodeJsScan can be found <a href="https://github.com/tariqahmed1912/internship-kloudle/blob/main/reports/nodejsscan-report">here</a>.</p>
<hr />
<h3 id="auditjs"><strong>Auditjs</strong></h3>
<p>Auditjs is a SAST tool which detects vulnerablilites in dependencies (node modules) used in your application. It interacts with Sonatype Nexus IQ Server to check for known and disclosed vulnerabailites.</p>
<p>In the Jenkins server, enter DVNA container in exec mode.</p>
<pre><code class="language-bash">sudo docker exec -it -u 0 dvna-app /bin/bash
</code></pre>
<p>Following the <a href="https://github.com/ajinabraham/nodejsscan">official documentation</a> available on GitHub, I installed auditjs using NPM (Node Packet Manager). To install <code>npm</code> and <code>nodejs</code> in <code>dvna-app</code> container in production server, I referred this <a href="https://www.tecmint.com/install-nodejs-npm-in-centos-ubuntu/">documentation</a> as it's clear and easy to follow. After running the following commands, the package versions are: <code>npm v6.14.14</code> and <code>nodejs v14.17.4</code>.<br />
<strong>Note:</strong> Installing nodejs from deb.nodesource.com comes with a prepackaged NPM. So you don't need to install <code>npm</code> using the <code>apt</code> package manager. Additionally, to update npm to latest version, use <code>sudo npm install latest-version</code> after running the commands below. </p>
<pre><code class="language-bash">sudo apt update
sudo curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash -
sudo apt install -y nodejs
</code></pre>
<p>Install auditjs using npm.</p>
<pre><code class="language-bash">sudo npm install -g auditjs
</code></pre>
<p>Scan the <code>~/app</code> directory (which holds the files for DVNA) and store the scan result in <code>~/reports/auditjs-report</code>. </p>
<pre><code class="language-bash">cd ~/app
auditjs ossi &gt; ~/reports/auditjs-report
</code></pre>
<p>If your NodeJs project is very large, you might face rate-limit issues. To solve this issue, create a free account
at OSS Index and run the scan with your accounts <code>username</code> and <code>API-token</code>. </p>
<p><strong>Note</strong>: You can find the <code>API-token</code> in the <code>User Settings</code> after logging into the OSS Index website.</p>
<pre><code class="language-bash">auditjs ossi --username &lt;USERNAME&gt; --token &lt;API-TOKEN&gt; &gt; ~/reports/auditjs-report
</code></pre>
<h4 id="auditjs-pipeline"><strong>AuditJs Pipeline</strong></h4>
<pre><code class="language-bash">stage('Auditjs') {
  steps {
    sh 'cd ~/app; auditjs ossi &gt; ~/reports/auditjs-report || true'
  }
}
</code></pre>
<p>The complete report generated by AuditJs can be found <a href="https://github.com/tariqahmed1912/internship-kloudle/blob/main/reports/auditjs-report">here</a>.</p>
<hr />
<h3 id="sast-pipeline"><strong>SAST Pipeline</strong></h3>
<p>The static analysis is done on the application source code in <code>dvna-app</code> container running on Jenkins server.</p>
<p>Add the following stages to the Jenkinsfile for performing SAST of DVNA.</p>
<pre><code class="language-bash">stage('NodeJsScan') {
  steps {
    sh 'njsscan --json -o ~/reports/nodejsscan-report ~/app || true'
  }
}

stage('Auditjs') {
  steps {
    sh 'cd ~/app; auditjs ossi &gt; ~/reports/auditjs-report || true'
  }
}
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../working_of_pipeline/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Working of Pipeline" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Working of Pipeline
            </div>
          </div>
        </a>
      
      
        
        <a href="../sca/" class="md-footer__link md-footer__link--next" aria-label="Next: Software Composition Analysis" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Software Composition Analysis
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.2b46852b.min.js"></script>
      
    
  </body>
</html>